<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OPS360 Uploader</title>
<style>
body{font-family:Arial,sans-serif;background:#080c18;color:#e2e8f0;display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;padding:20px;box-sizing:border-box}
.box{background:#141c35;border:1px solid #1e2d50;border-radius:12px;padding:32px;max-width:480px;width:100%;text-align:center}
h1{color:#f59e0b;margin-bottom:8px}p{color:#94a3b8;font-size:0.9rem;margin-bottom:24px}
.btn{background:#f59e0b;color:#080c18;border:none;padding:16px;border-radius:8px;font-size:1rem;font-weight:700;cursor:pointer;width:100%;margin-top:12px}
.btn:disabled{opacity:0.5}
input[type=file]{width:100%;padding:12px;background:#0d1225;border:2px dashed #f59e0b;border-radius:8px;color:#e2e8f0;margin-bottom:8px;box-sizing:border-box}
.status{margin-top:16px;padding:12px;border-radius:8px;font-size:0.9rem;display:none}
.ok{background:rgba(16,185,129,0.2);border:1px solid #10b981;color:#10b981}
.err{background:rgba(239,68,68,0.2);border:1px solid #ef4444;color:#ef4444}
.info{background:rgba(59,130,246,0.2);border:1px solid #3b82f6;color:#3b82f6}
.bar{height:4px;background:#1e2d50;border-radius:2px;margin:16px 0;overflow:hidden}
.fill{height:100%;background:#f59e0b;width:0%;transition:width 0.4s ease;border-radius:2px}
</style>
</head>
<body>
<div class="box">
  <h1>‚òÅÔ∏è OPS360 Uploader</h1>
  <p>W√§hle deine gespeicherte <b>OPS360.html.txt</b> Datei ‚Äî sie wird automatisch als <b>OPS360.html</b> auf GitHub hochgeladen.</p>
  <input type="file" id="fileInput" accept=".html,.txt,.html.txt">
  <button class="btn" id="btn" onclick="upload()">üöÄ Auf GitHub hochladen</button>
  <div class="bar"><div class="fill" id="fill"></div></div>
  <div class="status" id="st"></div>
</div>
<script>
const T='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',O='ms150171',R='ops360',P='OPS360.html';
function st(m,t){const e=document.getElementById('st');e.textContent=m;e.className='status '+t;e.style.display='block';}
function prog(p){document.getElementById('fill').style.width=p+'%';}
async function upload(){
  const f=document.getElementById('fileInput').files[0];
  if(!f){st('‚ùå Bitte zuerst eine Datei ausw√§hlen','err');return;}
  const btn=document.getElementById('btn');
  btn.disabled=true;btn.textContent='‚è≥ Wird hochgeladen...';
  try{
    st('Datei wird gelesen...','info');prog(20);
    const text=await f.text();
    st('GitHub wird kontaktiert...','info');prog(40);
    const shaR=await fetch(`https://api.github.com/repos/${O}/${R}/contents/${P}`,
      {headers:{'Authorization':'token '+T,'Accept':'application/vnd.github.v3+json'}});
    const shaD=await shaR.json();
    if(!shaD.sha)throw new Error('SHA nicht gefunden: '+JSON.stringify(shaD));
    st('Datei wird hochgeladen...','info');prog(70);
    const b64=btoa(unescape(encodeURIComponent(text)));
    const up=await fetch(`https://api.github.com/repos/${O}/${R}/contents/${P}`,{
      method:'PUT',
      headers:{'Authorization':'token '+T,'Accept':'application/vnd.github.v3+json','Content-Type':'application/json'},
      body:JSON.stringify({message:'OPS360 Update '+new Date().toISOString().slice(0,16).replace('T',' '),content:b64,sha:shaD.sha})
    });
    prog(100);
    if(up.ok){st('‚úÖ Erfolgreich! OPS360 ist in 1-2 Minuten aktuell.','ok');btn.textContent='‚úÖ Fertig!';btn.style.background='#10b981';}
    else{const e=await up.json();throw new Error(e.message);}
  }catch(e){st('‚ùå Fehler: '+e.message,'err');btn.disabled=false;btn.textContent='üîÑ Erneut versuchen';}
}
</script>
</body>
</html>
